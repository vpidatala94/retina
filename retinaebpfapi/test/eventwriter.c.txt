#include <stdio.h> #include <stdlib.h> #include <bpf/libbpf.h> int main() { struct bpf_object *obj; int prog_fd; obj = bpf_object__open_file("sockops.bpf.o", NULL); if (libbpf_get_error(obj)) { fprintf(stderr, "Error opening BPF object\n"); return 1; } if (bpf_object__load(obj)) { fprintf(stderr, "Error loading BPF object\n"); return 1; } prog_fd = bpf_program__fd(bpf_object__find_program_by_title(obj, "sockops")); if (prog_fd < 0) { fprintf(stderr, "Error finding BPF program\n"); return 1; } printf("eBPF program loaded successfully!\n"); // Additional code to attach the program to a hook point would be needed here return 0